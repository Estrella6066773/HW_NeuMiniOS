# 同学A的CLI功能测试指南

## 📖 这是什么？

这个指南用来测试同学A完成的功能。同学A主要负责：
1. **整个CLI系统**（就是那个显示 `>` 让你输入命令的地方）
2. **命令解析**（把你说的话翻译成系统能懂的命令）
3. **两个进程管理命令**：`plist`（看进程）和 `stop`（停进程）

---

## 🚀 第一步：启动系统

### 怎么做？
1. 打开终端（命令行窗口）
2. 进入项目目录
3. 编译并运行程序

### 具体命令：
```bash
cd C:\Users\Lenovo\HW_NeuMiniOS
# 编译（如果还没编译的话）
make
# 或者直接运行
./neuboot
```

### ✅ 成功标志：
看到这个提示符就对了：
```
>
```
这说明CLI系统已经启动，正在等待你输入命令！

---

## 🧪 测试1：CLI基本功能

### 测试1.1：输入命令
**做什么：** 输入一个简单的命令，看看系统能不能识别

**步骤：**
1. 在 `>` 后面输入：`help`
2. 按回车

**✅ 应该看到：**
```
> help
NeuMiniOS Command Reference:
===========================

File Operations:
  list                    - List all files in current directory
  view <filename>         - Display file contents
  ...
```

**❌ 如果出错：**
- 如果什么都没显示 → CLI主循环可能有问题
- 如果显示"Unknown command" → 命令解析可能有问题

---

### 测试1.2：命令解析（带参数）
**做什么：** 测试系统能不能正确识别带参数的命令

**步骤：**
1. 输入：`view datafile`
2. 按回车

**✅ 应该看到：**
- 如果文件存在：显示文件内容
- 如果文件不存在：显示错误信息（比如 "File not found"）

**❌ 如果出错：**
- 如果显示"Usage: view <filename>" → 参数解析可能有问题
- 如果显示"Unknown command" → 命令名识别有问题

---

### 测试1.3：错误处理
**做什么：** 测试系统对错误输入的处理

**步骤：**
1. 输入一个不存在的命令：`asdfghjkl`
2. 按回车

**✅ 应该看到：**
```
Error: Unknown command 'asdfghjkl'
Available commands:
  File operations: list, view, delete, copy, rename
  Process operations: plist, stop, run
  ...
Type 'help' for more information
```

**❌ 如果出错：**
- 如果程序崩溃 → 错误处理有问题
- 如果什么都不显示 → 错误处理不完善

---

## 🧪 测试2：命令历史功能（加分项）

### 测试2.1：执行上一条命令
**做什么：** 测试 `!!` 命令（执行上一条命令）

**步骤：**
1. 先输入：`list`
2. 按回车（应该看到文件列表）
3. 再输入：`!!`
4. 按回车

**✅ 应该看到：**
- 再次显示文件列表（说明 `!!` 执行了上一条 `list` 命令）

**❌ 如果出错：**
- 如果显示 "Error: No previous command in history" → 历史记录功能有问题
- 如果什么都不显示 → 历史记录可能没保存

---

### 测试2.2：连续相同命令
**做什么：** 测试系统会不会重复保存相同的命令

**步骤：**
1. 输入：`list`
2. 按回车
3. 再输入：`list`
4. 按回车
5. 输入：`!!`
6. 按回车

**✅ 应该看到：**
- `!!` 执行的是 `list` 命令（说明历史记录正常）

**说明：** 系统可能会跳过重复的连续命令，这是正常的优化。

---

## 🧪 测试3：进程管理命令 - plist

### 测试3.1：查看空进程列表
**做什么：** 测试 `plist` 命令在没有任何进程时的显示

**步骤：**
1. 输入：`plist`
2. 按回车

**✅ 应该看到：**
```
=== Running Processes (max 5) ===
PID        System PID Name                 Status
------------------------------------------------
(no running processes)
```

**❌ 如果出错：**
- 如果程序崩溃 → `list_processes()` 函数可能有问题
- 如果什么都不显示 → 输出格式可能有问题

---

### 测试3.2：查看有进程的列表
**做什么：** 测试 `plist` 命令在有进程时的显示

**步骤：**
1. 先运行一个程序：`run helloworld`（如果文件存在）
2. 按回车
3. 输入：`plist`
4. 按回车

**✅ 应该看到：**
```
=== Running Processes (max 5) ===
PID        System PID Name                 Status
------------------------------------------------
1          12345      helloworld           Running
Total: 1 process(es) running
```

**说明：**
- `PID` 是 NeuMiniOS 的进程ID（从1开始）
- `System PID` 是 Linux 系统的进程ID（数字很大）
- `Name` 是进程名称
- `Status` 显示 "Running"

**❌ 如果出错：**
- 如果显示格式混乱 → 输出格式化有问题
- 如果进程数不对 → 进程表更新有问题

---

## 🧪 测试4：进程管理命令 - stop

### 测试4.1：停止一个进程
**做什么：** 测试 `stop` 命令能否正确停止进程

**步骤：**
1. 先运行一个程序：`run helloworld`
2. 按回车（记下显示的进程ID，比如是 `1`）
3. 输入：`plist` 确认进程在运行
4. 输入：`stop 1`（用实际的进程ID）
5. 按回车
6. 再输入：`plist` 确认进程已停止

**✅ 应该看到：**
```
> stop 1
Process 1 (helloworld) stopped successfully
> plist
=== Running Processes (max 5) ===
PID        System PID Name                 Status
------------------------------------------------
(no running processes)
```

**❌ 如果出错：**
- 如果显示 "Process not found" → 进程查找有问题
- 如果进程还在运行 → 停止功能有问题
- 如果程序崩溃 → 信号处理有问题

---

### 测试4.2：错误处理 - 无效的进程ID
**做什么：** 测试 `stop` 命令对错误输入的处理

**步骤：**
1. 输入：`stop abc`
2. 按回车

**✅ 应该看到：**
```
Error: Invalid process ID 'abc'. Process ID must be a positive integer (1-2147483647).
Use 'plist' to see running processes and their IDs.
```

**❌ 如果出错：**
- 如果程序崩溃 → 参数验证有问题
- 如果显示其他错误 → 错误处理不完善

---

### 测试4.3：错误处理 - 不存在的进程
**做什么：** 测试停止一个不存在的进程

**步骤：**
1. 输入：`stop 999`
2. 按回车（假设进程999不存在）

**✅ 应该看到：**
```
Error: Process 999 not found or not running
Use 'plist' to see running processes
```

**❌ 如果出错：**
- 如果程序崩溃 → 错误处理有问题
- 如果什么都不显示 → 错误提示不完善

---

### 测试4.4：错误处理 - 缺少参数
**做什么：** 测试 `stop` 命令缺少参数时的处理

**步骤：**
1. 输入：`stop`
2. 按回车

**✅ 应该看到：**
```
Usage: stop <process_id>
Example: stop 1
```

**❌ 如果出错：**
- 如果程序崩溃 → 参数检查有问题
- 如果执行了其他操作 → 参数验证不完善

---

## 🧪 测试5：综合测试

### 测试5.1：完整流程
**做什么：** 测试整个CLI系统的完整工作流程

**步骤：**
1. 启动系统
2. 输入：`help`（查看帮助）
3. 输入：`list`（查看文件）
4. 输入：`plist`（查看进程，应该为空）
5. 输入：`run helloworld`（运行程序，如果有的话）
6. 输入：`plist`（再次查看进程，应该有一个进程）
7. 输入：`stop 1`（停止进程，用实际的PID）
8. 输入：`plist`（确认进程已停止）
9. 输入：`!!`（执行上一条命令，应该是 `plist`）
10. 输入：`exit`（退出系统）

**✅ 应该看到：**
- 每个命令都能正确执行
- 错误信息清晰
- 系统能正常退出

**❌ 如果出错：**
- 如果某个步骤失败 → 检查对应的功能
- 如果退出时崩溃 → 清理函数可能有问题

---

## 📋 测试检查清单

用这个清单来确保所有功能都测试过了：

### CLI核心功能
- [ ] CLI能正常启动（显示 `>` 提示符）
- [ ] 能输入命令并执行
- [ ] 命令解析正确（带参数的命令能正确识别）
- [ ] 错误处理完善（无效命令有提示）
- [ ] 能正常退出（`exit` 命令）

### 命令历史功能（加分项）
- [ ] `!!` 命令能执行上一条命令
- [ ] 历史记录能正确保存

### plist 命令
- [ ] 空进程列表显示正确
- [ ] 有进程时列表显示正确
- [ ] 进程信息格式正确（PID、System PID、Name、Status）

### stop 命令
- [ ] 能正确停止进程
- [ ] 停止后进程从列表中消失
- [ ] 无效进程ID有错误提示
- [ ] 不存在的进程有错误提示
- [ ] 缺少参数有使用说明

---

## 🐛 常见问题

### Q1: 输入命令后没反应？
**可能原因：**
- CLI主循环可能卡住了
- 命令解析可能失败但没有提示

**检查方法：**
- 输入 `help` 看看有没有反应
- 检查终端是否有错误信息

---

### Q2: plist 显示格式混乱？
**可能原因：**
- 输出格式化有问题
- 终端宽度不够

**检查方法：**
- 调整终端窗口大小
- 检查 `list_processes()` 函数的输出格式

---

### Q3: stop 命令执行后进程还在？
**可能原因：**
- 信号发送失败
- 进程状态没有更新

**检查方法：**
- 用系统的 `ps` 命令查看进程是否真的停止了
- 检查 `stop_process()` 函数的实现

---

### Q4: 命令历史不工作？
**可能原因：**
- 历史记录没有初始化
- `add_to_history()` 函数有问题

**检查方法：**
- 检查 `init_cli()` 是否正确初始化了历史记录
- 尝试输入多个命令，然后使用 `!!`

---

## 📝 测试报告模板

测试完成后，可以这样记录：

```
测试日期：___________
测试人员：___________

CLI核心功能：
- 启动：✅ / ❌
- 命令解析：✅ / ❌
- 错误处理：✅ / ❌

命令历史：
- !! 命令：✅ / ❌

plist 命令：
- 空列表显示：✅ / ❌
- 有进程显示：✅ / ❌

stop 命令：
- 停止进程：✅ / ❌
- 错误处理：✅ / ❌

总体评价：
_________________________________
_________________________________
```

---

## 🎯 总结

这个测试指南涵盖了同学A完成的所有主要功能：

1. ✅ **CLI系统** - 整个命令行界面
2. ✅ **命令解析** - 把用户输入转换成命令
3. ✅ **命令历史** - `!!` 功能（加分项）
4. ✅ **plist命令** - 查看进程列表
5. ✅ **stop命令** - 停止进程

按照这个指南测试，就能知道同学A的工作是否完成了！

---

祝测试顺利！🎉

